@model IEnumerable<AspNetIdentityTry1.Models.Item>

@{
    ViewBag.Title = "ShowAllOldItems";

    List<SelectListItem> userList = new List<SelectListItem>();

    if (ViewBag.allUsersName != null)
    {
        userList.Add(new SelectListItem
        {
            Text = "All",
            Value = "All"
        });

        foreach (var userName in ViewBag.allUsersName)
        {
            userList.Add(new SelectListItem
            {
                Text = userName,
                Value = userName
            });
        }
    }

    List<SelectListItem> numersPerPage = new List<SelectListItem>();
    numersPerPage.Add(new SelectListItem
    {
        Text = "5",
        Value = "5"
    });
    numersPerPage.Add(new SelectListItem
    {
        Text = "10",
        Value = "10"
    });
    numersPerPage.Add(new SelectListItem
    {
        Text = "20",
        Value = "20"
    });
    numersPerPage.Add(new SelectListItem
    {
        Text = "50",
        Value = "50"
    });
    numersPerPage.Add(new SelectListItem
    {
        Text = "100",
        Value = "100"
    });
}

<h2>All Old Items:</h2>

<div style="float: right">
    @*@using (Html.BeginForm("ShowAllOldItems", "ItemsPriority", FormMethod.Get))
    {
        <p style="float: right">
            <input type="submit" value="Show" class="btn btn-default" />
        </p>
        <p>@Html.DropDownList("userName", userList)</p>        
    }*@

    <div>
        <form action="/ItemsPriority/ShowAllOldItems" method="get">
            Number per page:
            @Html.DropDownList("numberPerPage", numersPerPage)
            @Html.DropDownList("userName", userList)
            <input type="submit" value="Apply" class="btn btn-default" />
        </form>
    </div>

</div>

<p>
    <input type="button" value="Create" class="btn btn-default" onclick="location.href='@Url.Action("CreateItemForUser", "ItemsPriority")'" />
</p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.Name)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Description)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Priority)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Status)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.UserName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Created)
        </th>
        <th></th>
    </tr>

@foreach (var item in Model) {
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.Name)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Description)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Priority)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Status)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.UserName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Created)
        </td>
        <td>
            @Html.ActionLink("Edit", "EditItem", new { id=item.Id }) |            
            @Html.ActionLink("Delete", "DeleteItem", new { id=item.Id })
        </td>
    </tr>
}

</table>

<!-- CHANGES ADDED TO SUPPORT PAGINATION -->
<div style="font-size: 25px">
    Page:

    @for (int i = 1; i <= ViewBag.AllPageNumber; i++)
    {
        string sPage = i.ToString();

        @Html.ActionLink(sPage + " ", "ShowAllOldItems", new { page = i, numberPerPage = @ViewBag.NumberPerPage, userName = @ViewBag.UserName } );

    }
</div>


